var D=Object.defineProperty;var d=(u,t)=>D(u,"name",{value:t,configurable:!0});import{u as U}from"./useId.06feead9.js";import{b as P}from"./browser.cfbb4fdd.js";import{u as b}from"./useDom.cdb636d1.js";import{d as k,a,h as f,l as $,p as j,q as F,t as K}from"./vue.esm-bundler.780544ed.js";function I(u){const t=F(N,null);if(t===null){const l=new Error(`<${u} /> is missing a parent <LMenu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(l,I),l}return t}d(I,"useContext");const N=Symbol("MenuContext"),z=k({name:"LMenu",props:{field:{type:Object,default:()=>({})}},setup(u,{slots:t}){const l=a(null),e=a(null),s=a(null),n=a([]),o=a(null),r=a(null),c=a(null),h=a(0),S=a(u.field),g=d(()=>{document&&(document.removeEventListener("click",v),document.removeEventListener("keyup",v))},"unRegisterOverlay"),y=d(()=>{document&&(document.addEventListener("click",v),document.addEventListener("keyup",v))},"registerOverlay"),w=a(!1),T=d(()=>{w.value||y(),m.isOpen.value=!0},"onOpenPopup"),v=d(p=>{var M,E,L;const i=p==null?void 0:p.target;if(!(i&&(((M=b(m.domNode))==null?void 0:M.contains(i))||((E=b(m.menuNode))==null?void 0:E.contains(i))||((L=b(m.buttonNode))==null?void 0:L.contains(i))))){{const x=b(m.buttonNode);x==null||x.focus()}m.isOpen.value=!1,g()}},"onClosePopup"),O=d(p=>{n.value.forEach(function(i){var M;i===p&&(c.value=p,(M=b(a(p)))==null||M.focus())})},"onSetFocusToMenuitem"),A=d(p=>{let i=n.value.indexOf(c.value);switch(p.key){case"Up":case"ArrowUp":i--;break;case"ArrowDown":case"Down":i++;break}O(n.value[i])},"onChangeActiveIndex"),C=`menu-${U()}`,m={id:C,domNode:l,buttonNode:e,menuNode:s,menuItemsNode:n,firstMenuItem:o,lastMenuItem:r,activeItem:c,activeItemIndex:h,field:S,isOpen:w,registerOverlay:y,unRegisterOverlay:g,onOpenPopup:T,onClosePopup:v,onSetFocusToMenuitem:O,onChangeActiveIndex:A};return K(N,m),()=>f("div",{ref:l,id:`menu-${C}`},{default:()=>t.default?t.default({isOpen:w.value}):void 0})}}),G=k({props:{as:{type:[String,Object],default:"button"}},inheritAttrs:!1,setup(u,{slots:t,attrs:l}){const e=I("LMenuButton");return()=>{var n;const s={id:`menu-button-${e.id}`,ref:e.buttonNode,"aria-expanded":e.isOpen.value,"aria-controls":`menu-list-${e.id}`,...l,onKeydown:o=>{let r=!1;switch(o.key){case"Enter":case"ArrowDown":case"Down":e.onOpenPopup(),P.exports.nextTick(()=>{e.onSetFocusToMenuitem(e.firstMenuItem.value)}),r=!0;break;case"Esc":case"Escape":e.onClosePopup(),r=!0;break;case"Up":case"ArrowUp":e.onOpenPopup(),P.exports.nextTick(()=>{e.onSetFocusToMenuitem(e.lastMenuItem.value)}),r=!0;break}r&&(o.stopPropagation(),o.preventDefault())},onClick:()=>{e.isOpen.value?e.onClosePopup():e.onOpenPopup()}};if(u.as=="template"){const o=(n=t.default)==null?void 0:n.call(t),r=o!=null&&o.length?o[0]:o;return r?f(r,s):null}else return f(u.as,s,{default:()=>t.default?t.default():[]})}}}),J=k({setup(u,{slots:t,attrs:l}){const e=I("LMenuItems");return()=>f("div",{id:`menu-list-${e.id}`,ref:e.menuNode,role:"menu"},{default:()=>t.default?t.default():[]})}}),Q=k({props:{as:{type:[String,Object],default:"ul"}},setup(u,{slots:t}){return()=>f(u.as,{role:"presentation"},{default:()=>t.default?t.default():[]})}}),V=k({props:{as:{type:[String,Object],default:"a"}},setup(u,{slots:t,attrs:l}){const e=I("LMenuItem"),s=a(null);return $(()=>{e.menuItemsNode.value.push(s.value),e.firstMenuItem.value||(e.firstMenuItem.value=s.value),e.lastMenuItem.value=s.value}),j(()=>{const n=e.menuItemsNode.value.indexOf(s.value);e.menuItemsNode.value.slice(n,1)}),()=>f(u.as,{...l,ref:s,role:"menuitem",tabindex:s.value==e.activeItem.value?0:-1,onKeydown:n=>{const o=n.currentTarget,r=n.key;let c=!1;if(!(n.ctrlKey||n.altKey||n.metaKey)){switch(r){case"Enter":o==null||o.click(),e.onClosePopup(),c=!0;break;case"Esc":case"Escape":e.onClosePopup(),c=!0;break;case"Up":case"ArrowUp":e.onChangeActiveIndex(n),c=!0;break;case"ArrowDown":case"Down":e.onChangeActiveIndex(n),c=!0;break;case"Home":case"PageUp":e.onSetFocusToMenuitem(e.firstMenuItem.value),c=!0;break;case"End":case"PageDown":e.onSetFocusToMenuitem(e.lastMenuItem.value),c=!0;break;case"Tab":e.onClosePopup();break}c&&(n.stopPropagation(),n.preventDefault())}},onClick:()=>{e.onClosePopup()}},{default:()=>t.default?t.default():[]})}});export{z as L,G as a,V as b,J as c,Q as d};
//# sourceMappingURL=LMenu.0b5d16bd.js.map
