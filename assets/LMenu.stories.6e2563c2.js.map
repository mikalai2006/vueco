{"version":3,"file":"LMenu.stories.6e2563c2.js","sources":["../../node_modules/process/browser.js","../../src/composable/useDom.ts","../../src/components/LMenu/LMenu.ts"],"sourcesContent":["// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","import type { Ref, ComponentPublicInstance } from \"vue\";\n\nexport function useDom<T extends Element | ComponentPublicInstance>(\n  ref?: Ref<T | null>\n): T | null {\n  if (ref == null) return null;\n  if (ref.value == null) return null;\n\n  return \"$el\" in ref.value\n    ? (ref.value.$el.$el as T | null)\n      ? (ref.value.$el.$el as T | null)\n      : (ref.value.$el as T | null)\n    : ref.value;\n}\n","import { useId } from \"@/composable/useId\";\nimport { nextTick } from \"process\";\nimport { useDom } from \"@/composable/useDom\";\nimport {\n  defineComponent,\n  h,\n  ref,\n  type InjectionKey,\n  type Ref,\n  onMounted,\n  onUnmounted,\n  inject,\n  provide,\n  type PropType,\n} from \"vue\";\n\nfunction useContext(component: string) {\n  const context = inject(MenuContext, null);\n\n  if (context === null) {\n    const err = new Error(\n      `<${component} /> is missing a parent <LMenu /> component.`\n    );\n    if (Error.captureStackTrace) Error.captureStackTrace(err, useContext);\n    throw err;\n  }\n\n  return context;\n}\n\nexport interface IMenuItem {\n  id?: string | number;\n  title?: string;\n  description?: string;\n  group?: string;\n  parentId?: string;\n}\nexport interface IMenuField {\n  title?: string;\n  keyTitle?: string;\n  keyGroup: keyof IMenuItem;\n  items: IMenuItem[];\n}\n\nexport type StateMenuDefinition = {\n  // State\n  id: string;\n  domNode: Ref<HTMLElement | null>;\n  buttonNode: Ref<HTMLElement | null>;\n  menuNode: Ref<HTMLElement | null>;\n  menuItemsNode: Ref<(HTMLElement | null)[]>;\n\n  firstMenuItem: Ref<HTMLElement | null>;\n  lastMenuItem: Ref<HTMLElement | null>;\n  activeItem: Ref<HTMLElement | null>;\n  activeItemIndex: Ref<number>;\n\n  // menuItems: ComputedRef<IMenuItem[]>;\n\n  field: Ref<IMenuField>;\n\n  isOpen: Ref<boolean>;\n\n  registerOverlay: () => void;\n  unRegisterOverlay: () => void;\n  onOpenPopup: () => void;\n  onClosePopup: () => void;\n  onSetFocusToMenuitem: (newMenuitem: HTMLElement | null) => void;\n  onChangeActiveIndex: (e: KeyboardEvent) => void;\n};\n\nexport const MenuContext = Symbol(\n  \"MenuContext\"\n) as InjectionKey<StateMenuDefinition>;\n\nexport const LMenu = defineComponent({\n  props: {\n    field: {\n      type: Object as PropType<IMenuField>,\n      default: () => {\n        return {};\n      },\n    },\n  },\n  setup(props, { slots }) {\n    const domNode = ref<StateMenuDefinition[\"domNode\"][\"value\"]>(null);\n    const buttonNode = ref<StateMenuDefinition[\"buttonNode\"][\"value\"]>(null);\n    const menuNode = ref<StateMenuDefinition[\"menuNode\"][\"value\"]>(null);\n    const menuItemsNode = ref<StateMenuDefinition[\"menuItemsNode\"][\"value\"]>(\n      []\n    );\n\n    const firstMenuItem =\n      ref<StateMenuDefinition[\"firstMenuItem\"][\"value\"]>(null);\n    const lastMenuItem =\n      ref<StateMenuDefinition[\"lastMenuItem\"][\"value\"]>(null);\n    const activeItem = ref<StateMenuDefinition[\"activeItem\"][\"value\"]>(null);\n    const activeItemIndex =\n      ref<StateMenuDefinition[\"activeItemIndex\"][\"value\"]>(0);\n    const field = ref<StateMenuDefinition[\"field\"][\"value\"]>(props.field);\n    // const menuItems = computed<StateMenuDefinition[\"menuItems\"][\"value\"]>(\n    //   () => props.field.items\n    // );\n\n    const unRegisterOverlay = () => {\n      if (document) {\n        document.removeEventListener(\"click\", onClosePopup);\n        document.removeEventListener(\"keyup\", onClosePopup);\n      }\n      console.log(\"unRegisterOverlay\");\n    };\n\n    const registerOverlay = () => {\n      if (document) {\n        document.addEventListener(\"click\", onClosePopup);\n        document.addEventListener(\"keyup\", onClosePopup);\n      }\n      console.log(\"registerOverlay\");\n    };\n\n    const isOpen = ref<StateMenuDefinition[\"isOpen\"][\"value\"]>(false);\n    const onOpenPopup = () => {\n      if (!isOpen.value) {\n        registerOverlay();\n      }\n      menu.isOpen.value = true;\n    };\n    const onClosePopup = (e: Event) => {\n      const tgt = e?.target as HTMLInputElement | null;\n\n      if (\n        tgt &&\n        (useDom(menu.domNode)?.contains(tgt) ||\n          useDom(menu.menuNode)?.contains(tgt) ||\n          useDom(menu.buttonNode)?.contains(tgt))\n      ) {\n        return;\n      }\n\n      const btn = useDom(menu.buttonNode);\n      menu.isOpen.value = false;\n\n      btn?.focus();\n      unRegisterOverlay();\n    };\n\n    const onSetFocusToMenuitem = (newMenuitem: HTMLElement | null) => {\n      console.log(\"onSetFocusToMenuitem\", newMenuitem);\n\n      menuItemsNode.value.forEach(function (item) {\n        if (item === newMenuitem) {\n          activeItem.value = newMenuitem;\n          useDom(ref(newMenuitem))?.focus();\n        }\n      });\n    };\n\n    const onChangeActiveIndex = (e: KeyboardEvent) => {\n      let index = menuItemsNode.value.indexOf(activeItem.value);\n      switch (e.key) {\n        case \"Up\":\n        case \"ArrowUp\":\n          index--;\n          break;\n\n        case \"ArrowDown\":\n        case \"Down\":\n          index++;\n          break;\n\n        default:\n          break;\n      }\n\n      onSetFocusToMenuitem(menuItemsNode.value[index]);\n    };\n\n    const idMenu = useId();\n    const id: StateMenuDefinition[\"id\"] = `menu-${idMenu}`;\n\n    const menu = {\n      id,\n\n      domNode,\n      buttonNode,\n      menuNode,\n      menuItemsNode,\n\n      firstMenuItem,\n      lastMenuItem,\n      activeItem,\n      activeItemIndex,\n\n      // menuItems,\n      field,\n\n      isOpen,\n\n      registerOverlay,\n      unRegisterOverlay,\n      onOpenPopup,\n      onClosePopup,\n\n      onSetFocusToMenuitem,\n      onChangeActiveIndex,\n    };\n\n    // onMounted(() => {\n    //   const _firstMenuItem = menuItemsNode.value[0];\n    //   const _lastMenuItem = menuItemsNode.value[menuItemsNode.value.length - 1];\n    //   firstMenuItem.value = _firstMenuItem;\n    //   lastMenuItem.value = _lastMenuItem;\n    // });\n\n    provide(MenuContext, menu);\n\n    return () =>\n      h(\n        \"div\",\n        {\n          ref: domNode,\n          id: `menu-${id}`,\n        },\n\n        {\n          default: () =>\n            slots.default\n              ? slots.default({\n                  menuItemsNode: menu.menuItemsNode.value,\n                  isOpen: isOpen.value,\n                })\n              : undefined,\n        }\n      );\n  },\n});\n\nexport const LMenuButton = defineComponent({\n  props: {\n    as: {\n      type: [String, Object],\n      default: \"button\",\n    },\n  },\n  setup(props, { slots }) {\n    const menu = useContext(\"LMenuButton\");\n    // let slotsChild: any = slots.default ? slots.default() : [];\n\n    onMounted(() => {\n      // if (typeof props.as == \"object\") {\n      //   slotsChild = () => Object.values(slots).map((x) => (x ? x() : []));\n      // }\n      // console.log(\"slotsChild\", slotsChild);\n    });\n\n    return () =>\n      h(\n        props.as as string,\n        {\n          id: `menu-button-${menu.id}`,\n          ref: menu.buttonNode,\n          \"aria-expanded\": menu.isOpen.value,\n          \"aria-controls\": `menu-list-${menu.id}`,\n          onKeydown: (e: KeyboardEvent) => {\n            let flag = false;\n            switch (e.key) {\n              case \"Enter\":\n              case \"ArrowDown\":\n              case \"Down\":\n                menu.onOpenPopup();\n                nextTick(() => {\n                  menu.onSetFocusToMenuitem(menu.firstMenuItem.value);\n                });\n                flag = true;\n                break;\n              case \"Esc\":\n              case \"Escape\":\n                menu.onClosePopup();\n                // menu.buttonNode.value?.focus();\n                flag = true;\n                break;\n              case \"Up\":\n              case \"ArrowUp\":\n                menu.onOpenPopup();\n                nextTick(() => {\n                  menu.onSetFocusToMenuitem(menu.lastMenuItem.value);\n                });\n                flag = true;\n                break;\n              default:\n                break;\n            }\n\n            if (flag) {\n              e.stopPropagation();\n              e.preventDefault();\n            }\n          },\n          onclick: (e: MouseEvent) => {\n            if (menu.isOpen.value) {\n              menu.onClosePopup();\n              // menu.buttonNode.value?.focus();\n            } else {\n              menu.onOpenPopup();\n              // this.setFocusToFirstMenuitem();\n            }\n            e.stopPropagation();\n            e.preventDefault();\n          },\n        },\n        {\n          default: () => (slots.default ? slots.default({}) : []),\n        }\n      );\n  },\n});\n\nexport const LMenuItems = defineComponent({\n  // props: {},\n  setup(props, { slots, attrs }) {\n    const menu = useContext(\"LMenuItems\");\n\n    // function flattenFragments(children: VNode[]): VNode[] {\n    //   return children.flatMap((child) => {\n    //     if (child.type === Fragment) {\n    //       return flattenFragments(child.children as VNode[]);\n    //     }\n\n    //     return [child];\n    //   });\n    // }\n\n    // let childrenSlots = {};\n    // const listNode = ref({});\n    // onMounted(() => {\n    //   const slotDefault = slots.default ? slots.default() : [];\n    //   const [firstChild, ...otherChild] = slotDefault;\n    //   console.log(\"slotDefault\", slotDefault);\n\n    //   const parentNode = cloneVNode(firstChild, { ...attrs });\n\n    //   listNode.value = parentNode.children[0];\n    //   const listChildrensNode = listNode.value.children || [];\n    //   const items = listChildrensNode.map((x) => cloneVNode(x, {}));\n    //   childrenSlots = items.map((x) => {\n    //     // const type = x.children?.length > 1 ? LMenuItem : \"li\";\n    //     // const _props = x.children?.length > 1 ? { as: x.type } : {};\n    //     if (x.children?.length > 1) {\n    //       // console.log(\"x >\", x);\n    //       return h(\n    //         LMenuItem,\n    //         { as: x.type },\n    //         // () => x.children\n    //         {\n    //           default: () => {\n    //             return x.children ? x.children : [];\n    //           },\n    //         }\n    //       );\n    //     } else {\n    //       // console.log(\"x <\", x);\n    //       const [firstNode] = x.children;\n\n    //       return h(\n    //         x.type,\n    //         { role: \"presentation\" },\n    //         // () => x.children\n    //         [\n    //           h(\n    //             LMenuItem,\n    //             { as: firstNode.type, ...firstNode.props },\n    //             // () => x.children\n    //             {\n    //               default: () => {\n    //                 console.log(\"x.children\", firstNode.children);\n\n    //                 return firstNode.children.default\n    //                   ? firstNode.children.default()\n    //                   : firstNode.children;\n    //               },\n    //             }\n    //           ),\n    //         ]\n    //       );\n    //     }\n    //   });\n    //   console.log(\"parentNode\", listNode.value);\n    // });\n\n    return () =>\n      h(\n        \"div\",\n        {\n          id: `menu-list-${menu.id}`,\n          ref: menu.menuNode,\n          role: \"menu\",\n        },\n        {\n          default: () => (slots.default ? slots.default() : []),\n        }\n      );\n  },\n});\nexport const LMenuItemWrapper = defineComponent({\n  props: {\n    as: {\n      type: [String, Object],\n      default: \"ul\",\n    },\n  },\n  setup(props, { slots }) {\n    return () =>\n      h(\n        props.as as string,\n        {\n          role: \"presentation\",\n        },\n        {\n          default: () => (slots.default ? slots.default() : []),\n        }\n      );\n  },\n});\n\nexport const LMenuItem = defineComponent({\n  props: {\n    // item: {\n    //   type: Object,\n    //   default: () => {\n    //     return {};\n    //   },\n    // },\n    as: {\n      type: [String, Object],\n      default: \"a\",\n    },\n  },\n  setup(props, { slots, attrs }) {\n    const menu = useContext(\"LMenuItem\");\n\n    const menuitemNode = ref<StateMenuDefinition[\"menuNode\"][\"value\"]>(null);\n\n    // const slotDefault = slots.default()[0].children[0];\n    // if (!slotDefault) {\n    //   return;\n    // }\n    onMounted(() => {\n      menu.menuItemsNode.value.push(menuitemNode.value);\n      console.log(\"onMounted item\", menu.menuItemsNode.value);\n\n      // const _firstMenuItem = menuItemsNode.value[0];\n      // const _lastMenuItem = menuItemsNode.value[menuItemsNode.value.length - 1];\n      if (!menu.firstMenuItem.value) {\n        menu.firstMenuItem.value = menuitemNode.value;\n      }\n      menu.lastMenuItem.value = menuitemNode.value;\n    });\n\n    onUnmounted(() => {\n      const indexMenuitem = menu.menuItemsNode.value.indexOf(\n        menuitemNode.value\n      );\n      menu.menuItemsNode.value.slice(indexMenuitem, 1);\n    });\n\n    return () =>\n      h(\n        props.as as string,\n        {\n          ...attrs,\n          ref: menuitemNode,\n          role: \"menuitem\",\n          tabindex: menuitemNode.value == menu.activeItem.value ? 0 : -1,\n          onKeydown: (e: KeyboardEvent) => {\n            const tgt = e.currentTarget as HTMLElement,\n              key = e.key;\n            let flag = false;\n\n            if (e.ctrlKey || e.altKey || e.metaKey) {\n              return;\n            }\n\n            switch (key) {\n              case \"Enter\":\n                tgt?.click();\n                menu.onClosePopup();\n                flag = true;\n                break;\n\n              case \"Esc\":\n              case \"Escape\":\n                menu.onClosePopup();\n                // menu.buttonNode.value?.focus();\n                flag = true;\n                break;\n\n              case \"Up\":\n              case \"ArrowUp\":\n                menu.onChangeActiveIndex(e);\n                flag = true;\n                break;\n\n              case \"ArrowDown\":\n              case \"Down\":\n                menu.onChangeActiveIndex(e);\n                flag = true;\n                break;\n\n              case \"Home\":\n              case \"PageUp\":\n                menu.onSetFocusToMenuitem(menu.firstMenuItem.value);\n                flag = true;\n                break;\n\n              case \"End\":\n              case \"PageDown\":\n                menu.onSetFocusToMenuitem(menu.lastMenuItem.value);\n                flag = true;\n                break;\n\n              case \"Tab\":\n                menu.onClosePopup();\n                break;\n\n              default:\n                // if (isPrintableCharacter(key)) {\n                //   this.setFocusByFirstCharacter(tgt, key);\n                //   flag = true;\n                // }\n                break;\n            }\n            if (flag) {\n              e.stopPropagation();\n              e.preventDefault();\n            }\n          },\n          onClick: () => {\n            menu.onClosePopup();\n          },\n        },\n        {\n          default: () => (slots.default ? slots.default() : []),\n        }\n        // [h(slotDefault, { role: \"menuitem\",  })]\n      );\n  },\n});\n"],"names":["process","browserModule","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","__name","defaultClearTimeout","runTimeout","fun","runClearTimeout","marker","queue","draining","currentQueue","queueIndex","cleanUpNextTick","drainQueue","timeout","len","args","i","Item","array","noop","name","dir","useDom","ref","useContext","component","context","inject","MenuContext","err","LMenu","defineComponent","props","slots","domNode","buttonNode","menuNode","menuItemsNode","firstMenuItem","lastMenuItem","activeItem","activeItemIndex","field","unRegisterOverlay","onClosePopup","registerOverlay","isOpen","onOpenPopup","menu","e","tgt","_a","_b","_c","btn","onSetFocusToMenuitem","newMenuitem","item","onChangeActiveIndex","index","id","useId","provide","h","LMenuButton","onMounted","flag","nextTick","LMenuItems","attrs","LMenuItemWrapper","LMenuItem","menuitemNode","onUnmounted","indexMenuitem","key"],"mappings":"qsBACIA,EAAUC,EAAc,QAAG,GAO3BC,EACAC,EAEJ,SAASC,GAAmB,CACxB,MAAM,IAAI,MAAM,iCAAiC,CACrD,CAFSC,EAAAD,EAAA,oBAGT,SAASE,GAAuB,CAC5B,MAAM,IAAI,MAAM,mCAAmC,CACvD,CAFSD,EAAAC,EAAA,wBAGR,UAAY,CACT,GAAI,CACI,OAAO,YAAe,WACtBJ,EAAmB,WAEnBA,EAAmBE,CAE1B,MAAC,CACEF,EAAmBE,CACtB,CACD,GAAI,CACI,OAAO,cAAiB,WACxBD,EAAqB,aAErBA,EAAqBG,CAE5B,MAAC,CACEH,EAAqBG,CACxB,CACL,KACA,SAASC,EAAWC,EAAK,CACrB,GAAIN,IAAqB,WAErB,OAAO,WAAWM,EAAK,CAAC,EAG5B,IAAKN,IAAqBE,GAAoB,CAACF,IAAqB,WAChE,OAAAA,EAAmB,WACZ,WAAWM,EAAK,CAAC,EAE5B,GAAI,CAEA,OAAON,EAAiBM,EAAK,CAAC,CACjC,MAAC,CACE,GAAI,CAEA,OAAON,EAAiB,KAAK,KAAMM,EAAK,CAAC,CAC5C,MAAC,CAEE,OAAON,EAAiB,KAAK,KAAMM,EAAK,CAAC,CAC5C,CACJ,CAGL,CAxBSH,EAAAE,EAAA,cAyBT,SAASE,GAAgBC,EAAQ,CAC7B,GAAIP,IAAuB,aAEvB,OAAO,aAAaO,CAAM,EAG9B,IAAKP,IAAuBG,GAAuB,CAACH,IAAuB,aACvE,OAAAA,EAAqB,aACd,aAAaO,CAAM,EAE9B,GAAI,CAEA,OAAOP,EAAmBO,CAAM,CACnC,MAAC,CACE,GAAI,CAEA,OAAOP,EAAmB,KAAK,KAAMO,CAAM,CAC9C,MAAC,CAGE,OAAOP,EAAmB,KAAK,KAAMO,CAAM,CAC9C,CACJ,CAIL,CA1BSL,EAAAI,GAAA,mBA2BT,IAAIE,EAAQ,CAAA,EACRC,EAAW,GACXC,EACAC,EAAa,GAEjB,SAASC,IAAkB,CACnB,CAACH,GAAY,CAACC,IAGlBD,EAAW,GACPC,EAAa,OACbF,EAAQE,EAAa,OAAOF,CAAK,EAEjCG,EAAa,GAEbH,EAAM,QACNK,IAER,CAbSX,EAAAU,GAAA,mBAeT,SAASC,GAAa,CAClB,GAAI,CAAAJ,EAGJ,KAAIK,EAAUV,EAAWQ,EAAe,EACxCH,EAAW,GAGX,QADIM,EAAMP,EAAM,OACVO,GAAK,CAGP,IAFAL,EAAeF,EACfA,EAAQ,CAAA,EACD,EAAEG,EAAaI,GACdL,GACAA,EAAaC,GAAY,MAGjCA,EAAa,GACbI,EAAMP,EAAM,MACf,CACDE,EAAe,KACfD,EAAW,GACXH,GAAgBQ,CAAO,EAC3B,CAtBSZ,EAAAW,EAAA,cAwBThB,EAAQ,SAAW,SAAUQ,EAAK,CAC9B,IAAIW,EAAO,IAAI,MAAM,UAAU,OAAS,CAAC,EACzC,GAAI,UAAU,OAAS,EACnB,QAASC,EAAI,EAAGA,EAAI,UAAU,OAAQA,IAClCD,EAAKC,EAAI,GAAK,UAAUA,GAGhCT,EAAM,KAAK,IAAIU,EAAKb,EAAKW,CAAI,CAAC,EAC1BR,EAAM,SAAW,GAAK,CAACC,GACvBL,EAAWS,CAAU,CAE7B,EAGA,SAASK,EAAKb,EAAKc,EAAO,CACtB,KAAK,IAAMd,EACX,KAAK,MAAQc,CACjB,CAHSjB,EAAAgB,EAAA,QAITA,EAAK,UAAU,IAAM,UAAY,CAC7B,KAAK,IAAI,MAAM,KAAM,KAAK,KAAK,CACnC,EACArB,EAAQ,MAAQ,UAChBA,EAAQ,QAAU,GAClBA,EAAQ,IAAM,CAAA,EACdA,EAAQ,KAAO,CAAA,EACfA,EAAQ,QAAU,GAClBA,EAAQ,SAAW,CAAA,EAEnB,SAASuB,GAAO,CAAE,CAATlB,EAAAkB,EAAA,QAETvB,EAAQ,GAAKuB,EACbvB,EAAQ,YAAcuB,EACtBvB,EAAQ,KAAOuB,EACfvB,EAAQ,IAAMuB,EACdvB,EAAQ,eAAiBuB,EACzBvB,EAAQ,mBAAqBuB,EAC7BvB,EAAQ,KAAOuB,EACfvB,EAAQ,gBAAkBuB,EAC1BvB,EAAQ,oBAAsBuB,EAE9BvB,EAAQ,UAAY,SAAUwB,EAAM,CAAE,MAAO,CAAA,CAAI,EAEjDxB,EAAQ,QAAU,SAAUwB,EAAM,CAC9B,MAAM,IAAI,MAAM,kCAAkC,CACtD,EAEAxB,EAAQ,IAAM,UAAY,CAAE,MAAO,KACnCA,EAAQ,MAAQ,SAAUyB,EAAK,CAC3B,MAAM,IAAI,MAAM,gCAAgC,CACpD,EACAzB,EAAQ,MAAQ,UAAW,CAAE,MAAO,EAAI,ECrLjC,SAAS0B,EACdC,EACU,CAEV,OADIA,GAAO,MACPA,EAAI,OAAS,KAAa,KAEvB,QAASA,EAAI,MACfA,EAAI,MAAM,IAAI,IACZA,EAAI,MAAM,IAAI,IACdA,EAAI,MAAM,IACbA,EAAI,KACV,CAXgBtB,EAAAqB,EAAA,UCchB,SAASE,EAAWC,EAAmB,CAC/B,MAAAC,EAAUC,GAAOC,EAAa,IAAI,EAExC,GAAIF,IAAY,KAAM,CACpB,MAAMG,EAAM,IAAI,MACd,IAAIJ,+CAAA,EAEN,MAAI,MAAM,mBAAyB,MAAA,kBAAkBI,EAAKL,CAAU,EAC9DK,CACR,CAEO,OAAAH,CACT,CAZSzB,EAAAuB,EAAA,cAuDF,MAAMI,EAAc,OACzB,aACF,EAEaE,EAAQC,EAAgB,CACnC,MAAO,CACL,MAAO,CACL,KAAM,OACN,QAAS,KACA,GAEX,CACF,EACA,MAAMC,EAAO,CAAE,MAAAC,GAAS,CAChB,MAAAC,EAAUX,EAA6C,IAAI,EAC3DY,EAAaZ,EAAgD,IAAI,EACjEa,EAAWb,EAA8C,IAAI,EAC7Dc,EAAgBd,EACpB,CAAC,CAAA,EAGGe,EACJf,EAAmD,IAAI,EACnDgB,EACJhB,EAAkD,IAAI,EAClDiB,EAAajB,EAAgD,IAAI,EACjEkB,GACJlB,EAAqD,CAAC,EAClDmB,GAAQnB,EAA2CS,EAAM,KAAK,EAK9DW,EAAoB1C,EAAA,IAAM,CAC1B,WACO,SAAA,oBAAoB,QAAS2C,CAAY,EACzC,SAAA,oBAAoB,QAASA,CAAY,GAEpD,QAAQ,IAAI,mBAAmB,CAAA,EALP,qBAQpBC,EAAkB5C,EAAA,IAAM,CACxB,WACO,SAAA,iBAAiB,QAAS2C,CAAY,EACtC,SAAA,iBAAiB,QAASA,CAAY,GAEjD,QAAQ,IAAI,iBAAiB,CAAA,EALP,mBAQlBE,EAASvB,EAA4C,EAAK,EAC1DwB,GAAc9C,EAAA,IAAM,CACnB6C,EAAO,OACMD,IAElBG,EAAK,OAAO,MAAQ,EAAA,EAJF,eAMdJ,EAAe3C,EAACgD,GAAa,WACjC,MAAMC,EAAMD,GAAA,YAAAA,EAAG,OAGb,GAAAC,MACCC,EAAA7B,EAAO0B,EAAK,OAAO,IAAnB,YAAAG,EAAsB,SAASD,OAC9BE,EAAA9B,EAAO0B,EAAK,QAAQ,IAApB,YAAAI,EAAuB,SAASF,OAChCG,EAAA/B,EAAO0B,EAAK,UAAU,IAAtB,YAAAK,EAAyB,SAASH,KAEpC,OAGI,MAAAI,EAAMhC,EAAO0B,EAAK,UAAU,EAClCA,EAAK,OAAO,MAAQ,GAEpBM,GAAA,MAAAA,EAAK,QACaX,GAAA,EAhBC,gBAmBfY,EAAuBtD,EAACuD,GAAoC,CACxD,QAAA,IAAI,uBAAwBA,CAAW,EAEjCnB,EAAA,MAAM,QAAQ,SAAUoB,EAAM,OACtCA,IAASD,IACXhB,EAAW,MAAQgB,GACnBL,EAAA7B,EAAOC,EAAIiC,CAAW,CAAC,IAAvB,MAAAL,EAA0B,QAC5B,CACD,CAAA,EAR0B,wBAWvBO,GAAsBzD,EAACgD,GAAqB,CAChD,IAAIU,EAAQtB,EAAc,MAAM,QAAQG,EAAW,KAAK,EACxD,OAAQS,EAAE,IAAK,CACb,IAAK,KACL,IAAK,UACHU,IACA,MAEF,IAAK,YACL,IAAK,OACHA,IACA,KAIJ,CAEqBJ,EAAAlB,EAAc,MAAMsB,EAAM,CAAA,EAjBrB,uBAqBtBC,EAAgC,QADvBC,OAGTb,EAAO,CACX,GAAAY,EAEA,QAAA1B,EACA,WAAAC,EACA,SAAAC,EACA,cAAAC,EAEA,cAAAC,EACA,aAAAC,EACA,WAAAC,EACA,gBAAAC,GAGA,MAAAC,GAEA,OAAAI,EAEA,gBAAAD,EACA,kBAAAF,EACA,YAAAI,GACA,aAAAH,EAEA,qBAAAW,EACA,oBAAAG,EAAA,EAUF,OAAAI,GAAQlC,EAAaoB,CAAI,EAElB,IACLe,EACE,MACA,CACE,IAAK7B,EACL,GAAI,QAAQ0B,GACd,EAEA,CACE,QAAS,IACP3B,EAAM,QACFA,EAAM,QAAQ,CACZ,cAAee,EAAK,cAAc,MAClC,OAAQF,EAAO,KAChB,CAAA,EACD,MACR,CAAA,CAEN,CACF,CAAC,EAEYkB,GAAcjC,EAAgB,CACzC,MAAO,CACL,GAAI,CACF,KAAM,CAAC,OAAQ,MAAM,EACrB,QAAS,QACX,CACF,EACA,MAAMC,EAAO,CAAE,MAAAC,GAAS,CAChB,MAAAe,EAAOxB,EAAW,aAAa,EAGrC,OAAAyC,EAAU,IAAM,CAAA,CAKf,EAEM,IACLF,EACE/B,EAAM,GACN,CACE,GAAI,eAAegB,EAAK,KACxB,IAAKA,EAAK,WACV,gBAAiBA,EAAK,OAAO,MAC7B,gBAAiB,aAAaA,EAAK,KACnC,UAAYC,GAAqB,CAC/B,IAAIiB,EAAO,GACX,OAAQjB,EAAE,IAAK,CACb,IAAK,QACL,IAAK,YACL,IAAK,OACHD,EAAK,YAAY,EACjBmB,EAAAA,QAAAA,SAAS,IAAM,CACRnB,EAAA,qBAAqBA,EAAK,cAAc,KAAK,CAAA,CACnD,EACMkB,EAAA,GACP,MACF,IAAK,MACL,IAAK,SACHlB,EAAK,aAAa,EAEXkB,EAAA,GACP,MACF,IAAK,KACL,IAAK,UACHlB,EAAK,YAAY,EACjBmB,EAAAA,QAAAA,SAAS,IAAM,CACRnB,EAAA,qBAAqBA,EAAK,aAAa,KAAK,CAAA,CAClD,EACMkB,EAAA,GACP,KAGJ,CAEIA,IACFjB,EAAE,gBAAgB,EAClBA,EAAE,eAAe,EAErB,EACA,QAAUA,GAAkB,CACtBD,EAAK,OAAO,MACdA,EAAK,aAAa,EAGlBA,EAAK,YAAY,EAGnBC,EAAE,gBAAgB,EAClBA,EAAE,eAAe,CACnB,CACF,EACA,CACE,QAAS,IAAOhB,EAAM,QAAUA,EAAM,QAAQ,CAAE,CAAA,EAAI,CAAC,CACvD,CAAA,CAEN,CACF,CAAC,EAEYmC,GAAarC,EAAgB,CAExC,MAAMC,EAAO,CAAE,MAAAC,EAAO,MAAAoC,GAAS,CACvB,MAAArB,EAAOxB,EAAW,YAAY,EAqEpC,MAAO,IACLuC,EACE,MACA,CACE,GAAI,aAAaf,EAAK,KACtB,IAAKA,EAAK,SACV,KAAM,MACR,EACA,CACE,QAAS,IAAOf,EAAM,QAAUA,EAAM,UAAY,CAAC,CACrD,CAAA,CAEN,CACF,CAAC,EACYqC,EAAmBvC,EAAgB,CAC9C,MAAO,CACL,GAAI,CACF,KAAM,CAAC,OAAQ,MAAM,EACrB,QAAS,IACX,CACF,EACA,MAAMC,EAAO,CAAE,MAAAC,GAAS,CACtB,MAAO,IACL8B,EACE/B,EAAM,GACN,CACE,KAAM,cACR,EACA,CACE,QAAS,IAAOC,EAAM,QAAUA,EAAM,UAAY,CAAC,CACrD,CAAA,CAEN,CACF,CAAC,EAEYsC,EAAYxC,EAAgB,CACvC,MAAO,CAOL,GAAI,CACF,KAAM,CAAC,OAAQ,MAAM,EACrB,QAAS,GACX,CACF,EACA,MAAMC,EAAO,CAAE,MAAAC,EAAO,MAAAoC,GAAS,CACvB,MAAArB,EAAOxB,EAAW,WAAW,EAE7BgD,EAAejD,EAA8C,IAAI,EAMvE,OAAA0C,EAAU,IAAM,CACdjB,EAAK,cAAc,MAAM,KAAKwB,EAAa,KAAK,EAChD,QAAQ,IAAI,iBAAkBxB,EAAK,cAAc,KAAK,EAIjDA,EAAK,cAAc,QACjBA,EAAA,cAAc,MAAQwB,EAAa,OAErCxB,EAAA,aAAa,MAAQwB,EAAa,KAAA,CACxC,EAEDC,GAAY,IAAM,CACV,MAAAC,EAAgB1B,EAAK,cAAc,MAAM,QAC7CwB,EAAa,KAAA,EAEfxB,EAAK,cAAc,MAAM,MAAM0B,EAAe,CAAC,CAAA,CAChD,EAEM,IACLX,EACE/B,EAAM,GACN,CACE,GAAGqC,EACH,IAAKG,EACL,KAAM,WACN,SAAUA,EAAa,OAASxB,EAAK,WAAW,MAAQ,EAAI,GAC5D,UAAYC,GAAqB,CAC/B,MAAMC,EAAMD,EAAE,cACZ0B,EAAM1B,EAAE,IACV,IAAIiB,EAAO,GAEX,GAAI,EAAAjB,EAAE,SAAWA,EAAE,QAAUA,EAAE,SAI/B,QAAQ0B,EAAK,CACX,IAAK,QACHzB,GAAA,MAAAA,EAAK,QACLF,EAAK,aAAa,EACXkB,EAAA,GACP,MAEF,IAAK,MACL,IAAK,SACHlB,EAAK,aAAa,EAEXkB,EAAA,GACP,MAEF,IAAK,KACL,IAAK,UACHlB,EAAK,oBAAoBC,CAAC,EACnBiB,EAAA,GACP,MAEF,IAAK,YACL,IAAK,OACHlB,EAAK,oBAAoBC,CAAC,EACnBiB,EAAA,GACP,MAEF,IAAK,OACL,IAAK,SACElB,EAAA,qBAAqBA,EAAK,cAAc,KAAK,EAC3CkB,EAAA,GACP,MAEF,IAAK,MACL,IAAK,WACElB,EAAA,qBAAqBA,EAAK,aAAa,KAAK,EAC1CkB,EAAA,GACP,MAEF,IAAK,MACHlB,EAAK,aAAa,EAClB,KAQJ,CACIkB,IACFjB,EAAE,gBAAgB,EAClBA,EAAE,eAAe,GAErB,EACA,QAAS,IAAM,CACbD,EAAK,aAAa,CACpB,CACF,EACA,CACE,QAAS,IAAOf,EAAM,QAAUA,EAAM,UAAY,CAAC,CACrD,CAAA,CAGN,CACF,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}